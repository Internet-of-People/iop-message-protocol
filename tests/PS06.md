### PS06xxx - Profile Search Related Functionality Tests

#### PS06001 - Profile Search - Simple Search

##### Prerequisites/Inputs

###### Prerequisites:
  * Server's database is empty.
  * "images/PS06001.jpg" file exists and contains JPEG image with size less than 20 kb

###### Inputs:
  * Server's IP address
  * Server's primary port


##### Description 

The test fills in the profile server's database with a newly created profiles and then performs several diffent search queries.


###### Step 1:

The test creates a primary identity which it uses for getting list of ports performing the search and then 
it creates the following identities, establishes hosting agreements with the profile server, and initialize their profiles, 
for the sole purpose of being able to search among their profiles:

  * $profileInfo1 is `version := [1,0,0], type := "Profile Type A", name := "Shanghai 1",   image := "images/PS06001.jpg", location := (31.23, 121.47),  extraData = null`
  * $profileInfo2 is `version := [1,0,0], type := "Profile Type A", name := "Mumbai 1",     image := "images/PS06001.jpg", location := (18.96, 72.82),   extraData = "t=running,Cycling,ice hockey,water polo"`
  * $profileInfo3 is `version := [1,0,0], type := "Profile Type A", name := "Karachi",      image := null,                 location := (24.86, 67.01),   extraData = "l=Karachi,PK;a=iop://185f8db32271fe25f561a6fc938b2e264306ec304eda518007d1764826381969;t=traveling,cycling,running"`
  * $profileInfo4 is `version := [1,0,0], type := "Profile Type B", name := "Buenos Aires", image := "images/PS06001.jpg", location := (-34.61, -58.37), extraData = null`
  * $profileInfo5 is `version := [1,0,0], type := "Profile Type B", name := "Shanghai 2",   image := null,                 location := (31.231, 121.47), extraData = "running"`
  * $profileInfo6 is `version := [1,0,0], type := "Profile Type C", name := "Mumbai 2",     image := "images/PS06001.jpg", location := (18.961, 72.82),  extraData = "MTg1ZjhkYjMyMjcxZmUyNWY1NjFhNmZjOTM4YjJlMjY0MzA2ZWMzMDRlZGE1MTgwMDdkMTc2NDgyNjM4MTk2OQ=="`
  * $profileInfo7 is `version := [1,0,0], type := "Profile Type C", name := "Mumbai 3",     image := null,                 location := (18.961, 72.82),  extraData = "t=running;l=Mumbai,IN"`



###### Step 2:

Using the primary identity, the test establishes a new TLS connection to the profile server's clNonCustomer port 
and sends *StartConversationRequest*:

  * `Message.id := 1`
  * `StartConversationRequest.supportedVersions := [[1,0,0]]`
  * `StartConversationRequest.publicKey` set to the test identity's 32 byte long public key
  * `StartConversationRequest.clientChallenge` set to 32 byte random challenge; `$ClientChallenge := StartConversationRequest.clientChallenge`
 
and reads the response.

Then it sends *ProfileSearchRequest* to find all test profiles:

  * `Message.id := 2`
  * `ProfileSearchRequest.includeHostedOnly := false`
  * `ProfileSearchRequest.includeThumbnailImages := true`
  * `ProfileSearchRequest.maxResponseRecordCount := 100`
  * `ProfileSearchRequest.maxTotalRecordCount := 100`
  * `ProfileSearchRequest.type := ""`
  * `ProfileSearchRequest.name := ""`
  * `ProfileSearchRequest.latitude := NO_LOCATION`
  * `ProfileSearchRequest.longitude := NO_LOCATION`
  * `ProfileSearchRequest.radius := 0`
  * `ProfileSearchRequest.extraData := ""`

and reads the response.


###### Step 3:

Then it sends *ProfileSearchRequest* to find profiles 4 and 5 by their type:

  * `Message.id := 3`
  * `ProfileSearchRequest.includeHostedOnly := false`
  * `ProfileSearchRequest.includeThumbnailImages := true`
  * `ProfileSearchRequest.maxResponseRecordCount := 100`
  * `ProfileSearchRequest.maxTotalRecordCount := 100`
  * `ProfileSearchRequest.type := "*Type B"`
  * `ProfileSearchRequest.name := ""`
  * `ProfileSearchRequest.latitude := NO_LOCATION`
  * `ProfileSearchRequest.longitude := NO_LOCATION`
  * `ProfileSearchRequest.radius := 0`
  * `ProfileSearchRequest.extraData := ""`

and reads the response.


###### Step 4:

Then it sends *ProfileSearchRequest* to find profiles 6 and 7 by their type:

  * `Message.id := 4`
  * `ProfileSearchRequest.includeHostedOnly := false`
  * `ProfileSearchRequest.includeThumbnailImages := true`
  * `ProfileSearchRequest.maxResponseRecordCount := 100`
  * `ProfileSearchRequest.maxTotalRecordCount := 100`
  * `ProfileSearchRequest.type := "Profile Type C"`
  * `ProfileSearchRequest.name := ""`
  * `ProfileSearchRequest.latitude := NO_LOCATION`
  * `ProfileSearchRequest.longitude := NO_LOCATION`
  * `ProfileSearchRequest.radius := 0`
  * `ProfileSearchRequest.extraData := ""`

and reads the response.

  
###### Step 5:

Then it sends *ProfileSearchRequest* to find profiles 2, 6 and 7 by their name:

  * `Message.id := 5`
  * `ProfileSearchRequest.includeHostedOnly := false`
  * `ProfileSearchRequest.includeThumbnailImages := true`
  * `ProfileSearchRequest.maxResponseRecordCount := 100`
  * `ProfileSearchRequest.maxTotalRecordCount := 100`
  * `ProfileSearchRequest.type := ""`
  * `ProfileSearchRequest.name := "Mumbai *"`
  * `ProfileSearchRequest.latitude := NO_LOCATION`
  * `ProfileSearchRequest.longitude := NO_LOCATION`
  * `ProfileSearchRequest.radius := 0`
  * `ProfileSearchRequest.extraData := ""`

and reads the response.

  
###### Step 6:

Then it sends *ProfileSearchRequest* to find profiles 1, 2, 4, 5, 6 and 7 by their name:

  * `Message.id := 6`
  * `ProfileSearchRequest.includeHostedOnly := false`
  * `ProfileSearchRequest.includeThumbnailImages := true`
  * `ProfileSearchRequest.maxResponseRecordCount := 100`
  * `ProfileSearchRequest.maxTotalRecordCount := 100`
  * `ProfileSearchRequest.type := ""`
  * `ProfileSearchRequest.name := "*ai*"`
  * `ProfileSearchRequest.latitude := NO_LOCATION`
  * `ProfileSearchRequest.longitude := NO_LOCATION`
  * `ProfileSearchRequest.radius := 0`
  * `ProfileSearchRequest.extraData := ""`

and reads the response.

  
###### Step 7:

Then it sends *ProfileSearchRequest* to find profiles 6 and 7 by their location:

  * `Message.id := 7`
  * `ProfileSearchRequest.includeHostedOnly := false`
  * `ProfileSearchRequest.includeThumbnailImages := true`
  * `ProfileSearchRequest.maxResponseRecordCount := 100`
  * `ProfileSearchRequest.maxTotalRecordCount := 100`
  * `ProfileSearchRequest.type := ""`
  * `ProfileSearchRequest.name := ""`
  * `ProfileSearchRequest.latitude := 18961000`
  * `ProfileSearchRequest.longitude := 72820000`
  * `ProfileSearchRequest.radius := 10`
  * `ProfileSearchRequest.extraData := ""`

and reads the response.

  
###### Step 8:

Then it sends *ProfileSearchRequest* to find profiles 2, 6 and 7 by their location:

  * `Message.id := 8`
  * `ProfileSearchRequest.includeHostedOnly := false`
  * `ProfileSearchRequest.includeThumbnailImages := true`
  * `ProfileSearchRequest.maxResponseRecordCount := 100`
  * `ProfileSearchRequest.maxTotalRecordCount := 100`
  * `ProfileSearchRequest.type := ""`
  * `ProfileSearchRequest.name := ""`
  * `ProfileSearchRequest.latitude := 18961000`
  * `ProfileSearchRequest.longitude := 72820000`
  * `ProfileSearchRequest.radius := 5000`
  * `ProfileSearchRequest.extraData := ""`

and reads the response.


###### Step 9:

Then it sends *ProfileSearchRequest* to find no profiles because of the location filter:

  * `Message.id := 9`
  * `ProfileSearchRequest.includeHostedOnly := false`
  * `ProfileSearchRequest.includeThumbnailImages := true`
  * `ProfileSearchRequest.maxResponseRecordCount := 100`
  * `ProfileSearchRequest.maxTotalRecordCount := 100`
  * `ProfileSearchRequest.type := ""`
  * `ProfileSearchRequest.name := ""`
  * `ProfileSearchRequest.latitude := -12345678`
  * `ProfileSearchRequest.longitude := 12345678`
  * `ProfileSearchRequest.radius := 5000`
  * `ProfileSearchRequest.extraData := ""`

and reads the response.


###### Step 10:

Then it sends *ProfileSearchRequest* to find no profiles because of the extra data filter:

  * `Message.id := 10`
  * `ProfileSearchRequest.includeHostedOnly := false`
  * `ProfileSearchRequest.includeThumbnailImages := true`
  * `ProfileSearchRequest.maxResponseRecordCount := 100`
  * `ProfileSearchRequest.maxTotalRecordCount := 100`
  * `ProfileSearchRequest.type := ""`
  * `ProfileSearchRequest.name := ""`
  * `ProfileSearchRequest.latitude := NO_LOCATION`
  * `ProfileSearchRequest.longitude := NO_LOCATION`
  * `ProfileSearchRequest.radius := 0`
  * `ProfileSearchRequest.extraData := "no profiles"`

and reads the response.


###### Step 11:

Then it sends *ProfileSearchRequest* to find profiles 2, 3 and 7 by their extraData information:

  * `Message.id := 11`
  * `ProfileSearchRequest.includeHostedOnly := false`
  * `ProfileSearchRequest.includeThumbnailImages := true`
  * `ProfileSearchRequest.maxResponseRecordCount := 100`
  * `ProfileSearchRequest.maxTotalRecordCount := 100`
  * `ProfileSearchRequest.type := ""`
  * `ProfileSearchRequest.name := ""`
  * `ProfileSearchRequest.latitude := NO_LOCATION`
  * `ProfileSearchRequest.longitude := NO_LOCATION`
  * `ProfileSearchRequest.radius := 0`
  * `ProfileSearchRequest.extraData := "(^|;)t=(|[^=]+,)running([;,]|$)"`

and reads the response.


###### Step 12:

Then it sends *ProfileSearchRequest* to find profiles 2, 3, 5, 6, 7, but only return first 2 records:

  * `Message.id := 12`
  * `ProfileSearchRequest.includeHostedOnly := false`
  * `ProfileSearchRequest.includeThumbnailImages := true`
  * `ProfileSearchRequest.maxResponseRecordCount := 2`
  * `ProfileSearchRequest.maxTotalRecordCount := 100`
  * `ProfileSearchRequest.type := ""`
  * `ProfileSearchRequest.name := ""`
  * `ProfileSearchRequest.latitude := NO_LOCATION`
  * `ProfileSearchRequest.longitude := NO_LOCATION`
  * `ProfileSearchRequest.radius := 0`
  * `ProfileSearchRequest.extraData := ".+"`

and reads the response. Then it sends *ProfileSearchPartRequest* to get the next 2 records:

  * `Message.id := 13`
  * `ProfileSearchPartRequest.recordIndex := 2`
  * `ProfileSearchPartRequest.recordCount := 2`

and reads the response. Then it sends *ProfileSearchPartRequest* to get the remaining record:

  * `Message.id := 14`
  * `ProfileSearchPartRequest.recordIndex := 4`
  * `ProfileSearchPartRequest.recordCount := 1`

and reads the response. Then it sends *ProfileSearchPartRequest* to get all records again:

  * `Message.id := 15`
  * `ProfileSearchPartRequest.recordIndex := 0`
  * `ProfileSearchPartRequest.recordCount := 5`

and reads the response.


###### Step 13:

Then it sends *ProfileSearchRequest* to find profiles 2, 3 and 7 by their extraData information, but only search for and get 2 records without images:

  * `Message.id := 16`
  * `ProfileSearchRequest.includeHostedOnly := false`
  * `ProfileSearchRequest.includeThumbnailImages := false`
  * `ProfileSearchRequest.maxResponseRecordCount := 2`
  * `ProfileSearchRequest.maxTotalRecordCount := 2`
  * `ProfileSearchRequest.type := ""`
  * `ProfileSearchRequest.name := ""`
  * `ProfileSearchRequest.latitude := NO_LOCATION`
  * `ProfileSearchRequest.longitude := NO_LOCATION`
  * `ProfileSearchRequest.radius := 0`
  * `ProfileSearchRequest.extraData := "(^|;)t=(|[^=]+,)running([;,]|$)"`

and reads the response.



###### Step 14:

Then it sends *ProfileSearchRequest* to find all profiles by their type:

  * `Message.id := 17`
  * `ProfileSearchRequest.includeHostedOnly := false`
  * `ProfileSearchRequest.includeThumbnailImages := true`
  * `ProfileSearchRequest.maxResponseRecordCount := 100`
  * `ProfileSearchRequest.maxTotalRecordCount := 100`
  * `ProfileSearchRequest.type := "profile*"`
  * `ProfileSearchRequest.name := ""`
  * `ProfileSearchRequest.latitude := NO_LOCATION`
  * `ProfileSearchRequest.longitude := NO_LOCATION`
  * `ProfileSearchRequest.radius := 0`
  * `ProfileSearchRequest.extraData := ""`

and reads the response.


  
###### Step 15:

Then it sends *ProfileSearchRequest* to find all profiles by their type:

  * `Message.id := 18`
  * `ProfileSearchRequest.includeHostedOnly := false`
  * `ProfileSearchRequest.includeThumbnailImages := true`
  * `ProfileSearchRequest.maxResponseRecordCount := 100`
  * `ProfileSearchRequest.maxTotalRecordCount := 100`
  * `ProfileSearchRequest.type := "*file*"`
  * `ProfileSearchRequest.name := ""`
  * `ProfileSearchRequest.latitude := NO_LOCATION`
  * `ProfileSearchRequest.longitude := NO_LOCATION`
  * `ProfileSearchRequest.radius := 0`
  * `ProfileSearchRequest.extraData := ""`

and reads the response.


  
###### Step 16:

Then it sends *ProfileSearchRequest* to find all profiles by their type:

  * `Message.id := 19`
  * `ProfileSearchRequest.includeHostedOnly := false`
  * `ProfileSearchRequest.includeThumbnailImages := true`
  * `ProfileSearchRequest.maxResponseRecordCount := 100`
  * `ProfileSearchRequest.maxTotalRecordCount := 100`
  * `ProfileSearchRequest.type := "**"`
  * `ProfileSearchRequest.name := ""`
  * `ProfileSearchRequest.latitude := NO_LOCATION`
  * `ProfileSearchRequest.longitude := NO_LOCATION`
  * `ProfileSearchRequest.radius := 0`
  * `ProfileSearchRequest.extraData := ""`

and reads the response.


  
###### Step 17:

Then it sends *ProfileSearchRequest* to find all profiles by their type:

  * `Message.id := 20`
  * `ProfileSearchRequest.includeHostedOnly := false`
  * `ProfileSearchRequest.includeThumbnailImages := true`
  * `ProfileSearchRequest.maxResponseRecordCount := 100`
  * `ProfileSearchRequest.maxTotalRecordCount := 100`
  * `ProfileSearchRequest.type := "*"`
  * `ProfileSearchRequest.name := ""`
  * `ProfileSearchRequest.latitude := NO_LOCATION`
  * `ProfileSearchRequest.longitude := NO_LOCATION`
  * `ProfileSearchRequest.radius := 0`
  * `ProfileSearchRequest.extraData := ""`

and reads the response.



###### Step 18:

Then it sends *ProfileSearchRequest* to find profiles 1 and 2 by their name:

  * `Message.id := 21`
  * `ProfileSearchRequest.includeHostedOnly := false`
  * `ProfileSearchRequest.includeThumbnailImages := true`
  * `ProfileSearchRequest.maxResponseRecordCount := 100`
  * `ProfileSearchRequest.maxTotalRecordCount := 100`
  * `ProfileSearchRequest.type := ""`
  * `ProfileSearchRequest.name := "*1"`
  * `ProfileSearchRequest.latitude := NO_LOCATION`
  * `ProfileSearchRequest.longitude := NO_LOCATION`
  * `ProfileSearchRequest.radius := 0`
  * `ProfileSearchRequest.extraData := ""`

and reads the response.


###### Step 19:

Then it sends *ProfileSearchRequest* to find profile 1 its name:

  * `Message.id := 22`
  * `ProfileSearchRequest.includeHostedOnly := false`
  * `ProfileSearchRequest.includeThumbnailImages := true`
  * `ProfileSearchRequest.maxResponseRecordCount := 100`
  * `ProfileSearchRequest.maxTotalRecordCount := 100`
  * `ProfileSearchRequest.type := ""`
  * `ProfileSearchRequest.name := "Shanghai 1"`
  * `ProfileSearchRequest.latitude := NO_LOCATION`
  * `ProfileSearchRequest.longitude := NO_LOCATION`
  * `ProfileSearchRequest.radius := 0`
  * `ProfileSearchRequest.extraData := ""`

and reads the response.



###### Step 20:

Then it sends *ProfileSearchRequest* to find all profiles by their name:

  * `Message.id := 23`
  * `ProfileSearchRequest.includeHostedOnly := false`
  * `ProfileSearchRequest.includeThumbnailImages := true`
  * `ProfileSearchRequest.maxResponseRecordCount := 100`
  * `ProfileSearchRequest.maxTotalRecordCount := 100`
  * `ProfileSearchRequest.type := ""`
  * `ProfileSearchRequest.name := "**"`
  * `ProfileSearchRequest.latitude := NO_LOCATION`
  * `ProfileSearchRequest.longitude := NO_LOCATION`
  * `ProfileSearchRequest.radius := 0`
  * `ProfileSearchRequest.extraData := ""`

and reads the response.



###### Step 21:

Then it sends *ProfileSearchRequest* to find all profiles by their name:

  * `Message.id := 24`
  * `ProfileSearchRequest.includeHostedOnly := false`
  * `ProfileSearchRequest.includeThumbnailImages := true`
  * `ProfileSearchRequest.maxResponseRecordCount := 100`
  * `ProfileSearchRequest.maxTotalRecordCount := 100`
  * `ProfileSearchRequest.type := ""`
  * `ProfileSearchRequest.name := "*"`
  * `ProfileSearchRequest.latitude := NO_LOCATION`
  * `ProfileSearchRequest.longitude := NO_LOCATION`
  * `ProfileSearchRequest.radius := 0`
  * `ProfileSearchRequest.extraData := ""`

and reads the response.


###### Step 22:

Then it sends *ProfileSearchRequest* to find profile 2 using multiple criteria:

  * `Message.id := 25`
  * `ProfileSearchRequest.includeHostedOnly := false`
  * `ProfileSearchRequest.includeThumbnailImages := true`
  * `ProfileSearchRequest.maxResponseRecordCount := 100`
  * `ProfileSearchRequest.maxTotalRecordCount := 100`
  * `ProfileSearchRequest.type := "*Type A"`
  * `ProfileSearchRequest.name := "*ai*"`
  * `ProfileSearchRequest.latitude := NO_LOCATION`
  * `ProfileSearchRequest.longitude := NO_LOCATION`
  * `ProfileSearchRequest.radius := 0`
  * `ProfileSearchRequest.extraData := "water"`

and reads the response.


###### Step 23:

Then it sends *ProfileSearchRequest* to find profiles 2, 3, 5, 6, 7, but only return first 2 records:

  * `Message.id := 26`
  * `ProfileSearchRequest.includeHostedOnly := false`
  * `ProfileSearchRequest.includeThumbnailImages := true`
  * `ProfileSearchRequest.maxResponseRecordCount := 2`
  * `ProfileSearchRequest.maxTotalRecordCount := 100`
  * `ProfileSearchRequest.type := ""`
  * `ProfileSearchRequest.name := ""`
  * `ProfileSearchRequest.latitude := NO_LOCATION`
  * `ProfileSearchRequest.longitude := NO_LOCATION`
  * `ProfileSearchRequest.radius := 0`
  * `ProfileSearchRequest.extraData := ".+"`

and reads the response. After 15 seconds wait, it sends *ProfileSearchPartRequest*:

  * `Message.id := 27`
  * `ProfileSearchPartRequest.recordIndex := 8`
  * `ProfileSearchPartRequest.recordCount := 2`

and reads the response. After 15 seconds wait, it sends *ProfileSearchPartRequest*:

  * `Message.id := 28`
  * `ProfileSearchPartRequest.recordIndex := 4`
  * `ProfileSearchPartRequest.recordCount := 5`

and reads the response. After 22 seconds wait, it sends *ProfileSearchPartRequest*:

  * `Message.id := 29`
  * `ProfileSearchPartRequest.recordIndex := 0`
  * `ProfileSearchPartRequest.recordCount := 500`

and reads the response. Then it sends *ProfileSearchPartRequest* to get all records:

  * `Message.id := 30`
  * `ProfileSearchPartRequest.recordIndex := 0`
  * `ProfileSearchPartRequest.recordCount := 5`

and reads the response.


  
##### Acceptance Criteria


###### Step 1:

The test successfully obtains list of ports on which the profile server provides its services. 
Then the test successfully establishes hosting agreements for its test identities.
Then the test successfully initializes all test profiles. 


###### Step 2:

Server replies with *StartConversationResponse*:
  
  * `Message.id == 1`
  * `Response.status == STATUS_OK`
  * `ConversationResponse.signature` is a valid signature of $ClientChallenge
  * `StartConversationResponse.clientChallenge == $ClientChallenge`


Server sends *ProfileSearchResponse*:

  * `Message.id == 2`
  * `Response.status == STATUS_OK`
  * `ProfileSearchResponse.totalRecordCount == 7`
  * `ProfileSearchResponse.maxResponseRecordCount == 100`
  * `ProfileSearchResponse.profiles.Count == 7`
  * `ProfileSearchResponse.profiles == 
    (
      {isHosted == true, isOnline == false; type, name, latitude, longitude, extraData match $profileInfo1; image != empty},
      {isHosted == true, isOnline == false; type, name, latitude, longitude, extraData match $profileInfo2; image != empty},
      {isHosted == true, isOnline == false; type, name, latitude, longitude, extraData match $profileInfo3; image == empty},
      {isHosted == true, isOnline == false; type, name, latitude, longitude, extraData match $profileInfo4; image != empty},
      {isHosted == true, isOnline == false; type, name, latitude, longitude, extraData match $profileInfo5; image == empty},
      {isHosted == true, isOnline == false; type, name, latitude, longitude, extraData match $profileInfo6; image != empty},
      {isHosted == true, isOnline == false; type, name, latitude, longitude, extraData match $profileInfo7; image == empty},
    )`



###### Step 3:

Server sends *ProfileSearchResponse*:

  * `Message.id == 3`
  * `Response.status == STATUS_OK`
  * `ProfileSearchResponse.totalRecordCount == 2`
  * `ProfileSearchResponse.maxResponseRecordCount == 100`
  * `ProfileSearchResponse.profiles.Count == 2`
  * `ProfileSearchResponse.profiles == 
    (
      {isHosted == true, isOnline == false; type, name, latitude, longitude, extraData match $profileInfo4; image != empty},
      {isHosted == true, isOnline == false; type, name, latitude, longitude, extraData match $profileInfo5; image == empty},
    )`




###### Step 4:

Server sends *ProfileSearchResponse*:

  * `Message.id == 4`
  * `Response.status == STATUS_OK`
  * `ProfileSearchResponse.totalRecordCount == 2`
  * `ProfileSearchResponse.maxResponseRecordCount == 100`
  * `ProfileSearchResponse.profiles.Count == 2`
  * `ProfileSearchResponse.profiles == 
    (
      {isHosted == true, isOnline == false; type, name, latitude, longitude, extraData match $profileInfo6; image != empty},
      {isHosted == true, isOnline == false; type, name, latitude, longitude, extraData match $profileInfo7; image == empty},
    )`

  
###### Step 5:

Server sends *ProfileSearchResponse*:

  * `Message.id == 5`
  * `Response.status == STATUS_OK`
  * `ProfileSearchResponse.totalRecordCount == 3`
  * `ProfileSearchResponse.maxResponseRecordCount == 100`
  * `ProfileSearchResponse.profiles.Count == 3`
  * `ProfileSearchResponse.profiles == 
    (
      {isHosted == true, isOnline == false; type, name, latitude, longitude, extraData match $profileInfo2; image != empty},
      {isHosted == true, isOnline == false; type, name, latitude, longitude, extraData match $profileInfo6; image != empty},
      {isHosted == true, isOnline == false; type, name, latitude, longitude, extraData match $profileInfo7; image == empty},
    )`

  
###### Step 6:

Server sends *ProfileSearchResponse*:

  * `Message.id == 6`
  * `Response.status == STATUS_OK`
  * `ProfileSearchResponse.totalRecordCount == 6`
  * `ProfileSearchResponse.maxResponseRecordCount == 100`
  * `ProfileSearchResponse.profiles.Count == 6`
  * `ProfileSearchResponse.profiles == 
    (
      {isHosted == true, isOnline == false; type, name, latitude, longitude, extraData match $profileInfo1; image != empty},
      {isHosted == true, isOnline == false; type, name, latitude, longitude, extraData match $profileInfo2; image != empty},
      {isHosted == true, isOnline == false; type, name, latitude, longitude, extraData match $profileInfo4; image != empty},
      {isHosted == true, isOnline == false; type, name, latitude, longitude, extraData match $profileInfo5; image == empty},
      {isHosted == true, isOnline == false; type, name, latitude, longitude, extraData match $profileInfo6; image != empty},
      {isHosted == true, isOnline == false; type, name, latitude, longitude, extraData match $profileInfo7; image == empty},
    )`

  
###### Step 7:

Server sends *ProfileSearchResponse*:

  * `Message.id == 7`
  * `Response.status == STATUS_OK`
  * `ProfileSearchResponse.totalRecordCount == 2`
  * `ProfileSearchResponse.maxResponseRecordCount == 100`
  * `ProfileSearchResponse.profiles.Count == 2`
  * `ProfileSearchResponse.profiles == 
    (
      {isHosted == true, isOnline == false; type, name, latitude, longitude, extraData match $profileInfo6; image != empty},
      {isHosted == true, isOnline == false; type, name, latitude, longitude, extraData match $profileInfo7; image == empty},
    )`

  
###### Step 8:

Server sends *ProfileSearchResponse*:

  * `Message.id == 8`
  * `Response.status == STATUS_OK`
  * `ProfileSearchResponse.totalRecordCount == 3`
  * `ProfileSearchResponse.maxResponseRecordCount == 100`
  * `ProfileSearchResponse.profiles.Count == 3`
  * `ProfileSearchResponse.profiles == 
    (
      {isHosted == true, isOnline == false; type, name, latitude, longitude, extraData match $profileInfo2; image != empty},
      {isHosted == true, isOnline == false; type, name, latitude, longitude, extraData match $profileInfo6; image != empty},
      {isHosted == true, isOnline == false; type, name, latitude, longitude, extraData match $profileInfo7; image == empty},
    )`


###### Step 9:

Server sends *ProfileSearchResponse*:

  * `Message.id == 9`
  * `Response.status == STATUS_OK`
  * `ProfileSearchResponse.totalRecordCount == 0`
  * `ProfileSearchResponse.maxResponseRecordCount == 100`
  * `ProfileSearchResponse.profiles.Count == 0`


###### Step 10:

Server sends *ProfileSearchResponse*:

  * `Message.id == 10`
  * `Response.status == STATUS_OK`
  * `ProfileSearchResponse.totalRecordCount == 0`
  * `ProfileSearchResponse.maxResponseRecordCount == 100`
  * `ProfileSearchResponse.profiles.Count == 0`


###### Step 11:

Server sends *ProfileSearchResponse*:

  * `Message.id == 11`
  * `Response.status == STATUS_OK`
  * `ProfileSearchResponse.totalRecordCount == 3`
  * `ProfileSearchResponse.maxResponseRecordCount == 100`
  * `ProfileSearchResponse.profiles.Count == 3`
  * `ProfileSearchResponse.profiles == 
    (
      {isHosted == true, isOnline == false; type, name, latitude, longitude, extraData match $profileInfo2; image != empty},
      {isHosted == true, isOnline == false; type, name, latitude, longitude, extraData match $profileInfo3; image == empty},
      {isHosted == true, isOnline == false; type, name, latitude, longitude, extraData match $profileInfo7; image == empty},
    )`



###### Step 12:

Server sends *ProfileSearchResponse*:

  * `Message.id == 12`
  * `Response.status == STATUS_OK`
  * `ProfileSearchResponse.totalRecordCount == 5`
  * `ProfileSearchResponse.maxResponseRecordCount == 2`
  * `ProfileSearchResponse.profiles.Count == 2`
  * `$SetA := ProfileSearchResponse.profiles`


Server sends *ProfileSearchPartResponse*:

  * `Message.id == 13`
  * `Response.status == STATUS_OK`
  * `ProfileSearchPartResponse.recordIndex == 2`
  * `ProfileSearchPartResponse.recordCount == 2`
  * `ProfileSearchPartResponse.profiles.Count == 2`
  * `$SetB := ProfileSearchPartResponse.profiles`


Server sends *ProfileSearchPartResponse*:

  * `Message.id == 14`
  * `Response.status == STATUS_OK`
  * `ProfileSearchPartResponse.recordIndex == 4`
  * `ProfileSearchPartResponse.recordCount == 1`
  * `ProfileSearchPartResponse.profiles.Count == 1`
  * `$SetC := ProfileSearchPartResponse.profiles`


Server sends *ProfileSearchPartResponse*:

  * `Message.id == 15`
  * `Response.status == STATUS_OK`
  * `ProfileSearchPartResponse.recordIndex == 0`
  * `ProfileSearchPartResponse.recordCount == 5`
  * `ProfileSearchPartResponse.profiles.Count == 5`
  * `$SetAll := ProfileSearchPartResponse.profiles ==
    (
      {isHosted == true, isOnline == false; type, name, latitude, longitude, extraData match $profileInfo2; image != empty},
      {isHosted == true, isOnline == false; type, name, latitude, longitude, extraData match $profileInfo3; image == empty},
      {isHosted == true, isOnline == false; type, name, latitude, longitude, extraData match $profileInfo5; image == empty},
      {isHosted == true, isOnline == false; type, name, latitude, longitude, extraData match $profileInfo6; image != empty},
      {isHosted == true, isOnline == false; type, name, latitude, longitude, extraData match $profileInfo7; image == empty},
    )`

  * `$SetA + $SetB + $SetC == $SetAll`



###### Step 13:

Server sends *ProfileSearchResponse*:

  * `Message.id == 16`
  * `Response.status == STATUS_OK`
  * `ProfileSearchResponse.totalRecordCount == 2`
  * `ProfileSearchResponse.maxResponseRecordCount == 100`
  * `ProfileSearchResponse.profiles.Count == 2`
  * `ProfileSearchResponse.profiles == any two of 
    (
      {isHosted == true, isOnline == false; type, name, latitude, longitude, extraData match $profileInfo2; image == empty},
      {isHosted == true, isOnline == false; type, name, latitude, longitude, extraData match $profileInfo3; image == empty},
      {isHosted == true, isOnline == false; type, name, latitude, longitude, extraData match $profileInfo7; image == empty},
    )`



###### Step 14:

Server sends *ProfileSearchResponse*:

  * `Message.id == 17`
  * `Response.status == STATUS_OK`
  * `ProfileSearchResponse.totalRecordCount == 7`
  * `ProfileSearchResponse.maxResponseRecordCount == 100`
  * `ProfileSearchResponse.profiles.Count == 7`
  * `ProfileSearchResponse.profiles == 
    (
      {isHosted == true, isOnline == false; type, name, latitude, longitude, extraData match $profileInfo1; image != empty},
      {isHosted == true, isOnline == false; type, name, latitude, longitude, extraData match $profileInfo2; image != empty},
      {isHosted == true, isOnline == false; type, name, latitude, longitude, extraData match $profileInfo3; image == empty},
      {isHosted == true, isOnline == false; type, name, latitude, longitude, extraData match $profileInfo4; image != empty},
      {isHosted == true, isOnline == false; type, name, latitude, longitude, extraData match $profileInfo5; image == empty},
      {isHosted == true, isOnline == false; type, name, latitude, longitude, extraData match $profileInfo6; image != empty},
      {isHosted == true, isOnline == false; type, name, latitude, longitude, extraData match $profileInfo7; image == empty},
    )`


###### Step 15:

Server sends *ProfileSearchResponse*:

  * `Message.id == 18`
  * `Response.status == STATUS_OK`
  * `ProfileSearchResponse.totalRecordCount == 7`
  * `ProfileSearchResponse.maxResponseRecordCount == 100`
  * `ProfileSearchResponse.profiles.Count == 7`
  * `ProfileSearchResponse.profiles == 
    (
      {isHosted == true, isOnline == false; type, name, latitude, longitude, extraData match $profileInfo1; image != empty},
      {isHosted == true, isOnline == false; type, name, latitude, longitude, extraData match $profileInfo2; image != empty},
      {isHosted == true, isOnline == false; type, name, latitude, longitude, extraData match $profileInfo3; image == empty},
      {isHosted == true, isOnline == false; type, name, latitude, longitude, extraData match $profileInfo4; image != empty},
      {isHosted == true, isOnline == false; type, name, latitude, longitude, extraData match $profileInfo5; image == empty},
      {isHosted == true, isOnline == false; type, name, latitude, longitude, extraData match $profileInfo6; image != empty},
      {isHosted == true, isOnline == false; type, name, latitude, longitude, extraData match $profileInfo7; image == empty},
    )`


###### Step 16:

Server sends *ProfileSearchResponse*:

  * `Message.id == 19`
  * `Response.status == STATUS_OK`
  * `ProfileSearchResponse.totalRecordCount == 7`
  * `ProfileSearchResponse.maxResponseRecordCount == 100`
  * `ProfileSearchResponse.profiles.Count == 7`
  * `ProfileSearchResponse.profiles == 
    (
      {isHosted == true, isOnline == false; type, name, latitude, longitude, extraData match $profileInfo1; image != empty},
      {isHosted == true, isOnline == false; type, name, latitude, longitude, extraData match $profileInfo2; image != empty},
      {isHosted == true, isOnline == false; type, name, latitude, longitude, extraData match $profileInfo3; image == empty},
      {isHosted == true, isOnline == false; type, name, latitude, longitude, extraData match $profileInfo4; image != empty},
      {isHosted == true, isOnline == false; type, name, latitude, longitude, extraData match $profileInfo5; image == empty},
      {isHosted == true, isOnline == false; type, name, latitude, longitude, extraData match $profileInfo6; image != empty},
      {isHosted == true, isOnline == false; type, name, latitude, longitude, extraData match $profileInfo7; image == empty},
    )`


###### Step 17:

Server sends *ProfileSearchResponse*:

  * `Message.id == 20`
  * `Response.status == STATUS_OK`
  * `ProfileSearchResponse.totalRecordCount == 7`
  * `ProfileSearchResponse.maxResponseRecordCount == 100`
  * `ProfileSearchResponse.profiles.Count == 7`
  * `ProfileSearchResponse.profiles == 
    (
      {isHosted == true, isOnline == false; type, name, latitude, longitude, extraData match $profileInfo1; image != empty},
      {isHosted == true, isOnline == false; type, name, latitude, longitude, extraData match $profileInfo2; image != empty},
      {isHosted == true, isOnline == false; type, name, latitude, longitude, extraData match $profileInfo3; image == empty},
      {isHosted == true, isOnline == false; type, name, latitude, longitude, extraData match $profileInfo4; image != empty},
      {isHosted == true, isOnline == false; type, name, latitude, longitude, extraData match $profileInfo5; image == empty},
      {isHosted == true, isOnline == false; type, name, latitude, longitude, extraData match $profileInfo6; image != empty},
      {isHosted == true, isOnline == false; type, name, latitude, longitude, extraData match $profileInfo7; image == empty},
    )`


###### Step 18:

Server sends *ProfileSearchResponse*:

  * `Message.id == 21`
  * `Response.status == STATUS_OK`
  * `ProfileSearchResponse.totalRecordCount == 2`
  * `ProfileSearchResponse.maxResponseRecordCount == 100`
  * `ProfileSearchResponse.profiles.Count == 2`
  * `ProfileSearchResponse.profiles == 
    (
      {isHosted == true, isOnline == false; type, name, latitude, longitude, extraData match $profileInfo1; image != empty},
      {isHosted == true, isOnline == false; type, name, latitude, longitude, extraData match $profileInfo2; image != empty},
    )`


###### Step 19:

Server sends *ProfileSearchResponse*:

  * `Message.id == 22`
  * `Response.status == STATUS_OK`
  * `ProfileSearchResponse.totalRecordCount == 1`
  * `ProfileSearchResponse.maxResponseRecordCount == 100`
  * `ProfileSearchResponse.profiles.Count == 1`
  * `ProfileSearchResponse.profiles == 
    (
      {isHosted == true, isOnline == false; type, name, latitude, longitude, extraData match $profileInfo1; image != empty},
    )`


###### Step 20:

Server sends *ProfileSearchResponse*:

  * `Message.id == 23`
  * `Response.status == STATUS_OK`
  * `ProfileSearchResponse.totalRecordCount == 7`
  * `ProfileSearchResponse.maxResponseRecordCount == 100`
  * `ProfileSearchResponse.profiles.Count == 7`
  * `ProfileSearchResponse.profiles == 
    (
      {isHosted == true, isOnline == false; type, name, latitude, longitude, extraData match $profileInfo1; image != empty},
      {isHosted == true, isOnline == false; type, name, latitude, longitude, extraData match $profileInfo2; image != empty},
      {isHosted == true, isOnline == false; type, name, latitude, longitude, extraData match $profileInfo3; image == empty},
      {isHosted == true, isOnline == false; type, name, latitude, longitude, extraData match $profileInfo4; image != empty},
      {isHosted == true, isOnline == false; type, name, latitude, longitude, extraData match $profileInfo5; image == empty},
      {isHosted == true, isOnline == false; type, name, latitude, longitude, extraData match $profileInfo6; image != empty},
      {isHosted == true, isOnline == false; type, name, latitude, longitude, extraData match $profileInfo7; image == empty},
    )`


###### Step 21:

Server sends *ProfileSearchResponse*:

  * `Message.id == 24`
  * `Response.status == STATUS_OK`
  * `ProfileSearchResponse.totalRecordCount == 7`
  * `ProfileSearchResponse.maxResponseRecordCount == 100`
  * `ProfileSearchResponse.profiles.Count == 7`
  * `ProfileSearchResponse.profiles == 
    (
      {isHosted == true, isOnline == false; type, name, latitude, longitude, extraData match $profileInfo1; image != empty},
      {isHosted == true, isOnline == false; type, name, latitude, longitude, extraData match $profileInfo2; image != empty},
      {isHosted == true, isOnline == false; type, name, latitude, longitude, extraData match $profileInfo3; image == empty},
      {isHosted == true, isOnline == false; type, name, latitude, longitude, extraData match $profileInfo4; image != empty},
      {isHosted == true, isOnline == false; type, name, latitude, longitude, extraData match $profileInfo5; image == empty},
      {isHosted == true, isOnline == false; type, name, latitude, longitude, extraData match $profileInfo6; image != empty},
      {isHosted == true, isOnline == false; type, name, latitude, longitude, extraData match $profileInfo7; image == empty},
    )`



###### Step 22:

Server sends *ProfileSearchResponse*:

  * `Message.id == 25`
  * `Response.status == STATUS_OK`
  * `ProfileSearchResponse.totalRecordCount == 1`
  * `ProfileSearchResponse.maxResponseRecordCount == 100`
  * `ProfileSearchResponse.profiles.Count == 1`
  * `ProfileSearchResponse.profiles == 
    (
      {isHosted == true, isOnline == false; type, name, latitude, longitude, extraData match $profileInfo2; image != empty},
    )`



###### Step 23:

Server sends *ProfileSearchResponse*:

  * `Message.id == 26`
  * `Response.status == STATUS_OK`
  * `ProfileSearchResponse.totalRecordCount == 5`
  * `ProfileSearchResponse.maxResponseRecordCount == 2`
  * `ProfileSearchResponse.profiles.Count == 2`


Server sends *Response*:

  * `Message.id == 27`
  * `Response.status == ERROR_INVALID_VALUE`
  * `Response.details == "recordIndex"`


Server sends *Response*:

  * `Message.id == 28`
  * `Response.status == ERROR_INVALID_VALUE`
  * `Response.details == "recordCount"`


Server sends *Response*:

  * `Message.id == 29`
  * `Response.status == ERROR_INVALID_VALUE`
  * `Response.details == "recordCount"`


Server sends *ProfileSearchPartResponse*:

  * `Message.id == 30`
  * `Response.status == STATUS_OK`
  * `ProfileSearchPartResponse.recordIndex == 0`
  * `ProfileSearchPartResponse.recordCount == 5`
  * `ProfileSearchPartResponse.profiles.Count == 5`
  * `$SetAll := ProfileSearchPartResponse.profiles ==
    (
      {isHosted == true, isOnline == false; type, name, latitude, longitude, extraData match $profileInfo2; image != empty},
      {isHosted == true, isOnline == false; type, name, latitude, longitude, extraData match $profileInfo3; image == empty},
      {isHosted == true, isOnline == false; type, name, latitude, longitude, extraData match $profileInfo5; image == empty},
      {isHosted == true, isOnline == false; type, name, latitude, longitude, extraData match $profileInfo6; image != empty},
      {isHosted == true, isOnline == false; type, name, latitude, longitude, extraData match $profileInfo7; image == empty},
    )`






#### PS06002 - Profile Search - Empty Database

##### Prerequisites/Inputs

###### Prerequisites:
  * Server's database is empty.

###### Inputs:
  * Server's IP address
  * Server's primary port


##### Description 

The test performs a search query when the profile server has empty database.


###### Step 1:

The test creates a primary identity which it uses for getting list of ports and then it establishes 
a new TLS connection to the profile server's clNonCustomer port and sends *StartConversationRequest*:

  * `Message.id := 1`
  * `StartConversationRequest.supportedVersions := [[1,0,0]]`
  * `StartConversationRequest.publicKey` set to the test identity's 32 byte long public key
  * `StartConversationRequest.clientChallenge` set to 32 byte random challenge; `$ClientChallenge := StartConversationRequest.clientChallenge`
 
and reads the response. 

Then it sends *ProfileSearchRequest*:

  * `Message.id := 2`
  * `ProfileSearchRequest.includeHostedOnly := false`
  * `ProfileSearchRequest.includeThumbnailImages := true`
  * `ProfileSearchRequest.maxResponseRecordCount := 100`
  * `ProfileSearchRequest.maxTotalRecordCount := 1000`
  * `ProfileSearchRequest.type := ""`
  * `ProfileSearchRequest.name := ""`
  * `ProfileSearchRequest.latitude := NO_LOCATION`
  * `ProfileSearchRequest.longitude := NO_LOCATION`
  * `ProfileSearchRequest.radius := 0`
  * `ProfileSearchRequest.extraData := ""`

and reads the response.


  
##### Acceptance Criteria


###### Step 1:

The test successfully obtains list of ports on which the profile server provides its services. 

Server replies with *StartConversationResponse*:
  
  * `Message.id == 1`
  * `Response.status == STATUS_OK`
  * `ConversationResponse.signature` is a valid signature of $ClientChallenge
  * `StartConversationResponse.clientChallenge == $ClientChallenge`


Server sends *ProfileSearchResponse*:

  * `Message.id == 1`
  * `Response.status == STATUS_OK`
  * `ProfileSearchResponse.totalRecordCount == 0`
  * `ProfileSearchResponse.maxResponseRecordCount == 100`
  * `ProfileSearchResponse.profiles.Count == 0`








#### PS06003 - Profile Search - Mass Location Search

##### Prerequisites/Inputs

###### Prerequisites:
  * Server's database is empty.

###### Inputs:
  * Server's IP address
  * Server's primary port


##### Description 

The test creates a large number of identities, for which it establishes hosting agreements with the profile server. 
Then it performs a number of search queries with a focus on GPS location of the created identities and verifies the results. 


###### Step 1:

The test creates a primary identity which it uses for getting list of ports and then that it will use for sending search queries. 

The test generates positive integers R1, R2, and R3:

  * `20,000 < R2 < 150,000`
  * `5,000 < R1 < 0.8 * R2`
  * `1.50 * R2 < R3 < 500,000`

The test generates 20 GPS locations, first 15 locations are generated as follows:

  * Location 1 is within R2 range of (0.0, 0.0),
  * location 2 is within R2 range of (89.9, 0.0),
  * location 3 is within R2 range of (-89.9, 0.0),
  * location 4 is within R2 range of (40.0, 0.0),
  * location 5 is within R2 range of (0.0, 179.9),
  * location 6 is within R2 range of (89.9, 179.9),
  * location 7 is within R2 range of (-89.9, 179.9),
  * location 8 is within R2 range of (40.0, 179.9),
  * location 9 is within R2 range of (0.0, -179.9),
  * location 10 is within R2 range of (89.9, -179.9),
  * location 11 is within R2 range of (-89.9, -179.9),
  * location 12 is within R2 range of (40.0, -179.9),
  * location 13 is within R2 range of (0.0, 50.0),
  * location 14 is within R2 range of (89.9, 50.0),
  * location 15 is within R2 range of (-89.9, 50.0).

the remaining 5 locations are random GPS locations.

For each of 20 locations, the test generates, establishes hosting agreements, and initializes profiles of 10 identities 
that are all located randomly within R1 range of the location, 10 identities within R2 range and 10 identities within R3 range.


###### Step 2:

The test performs search queries using *ProfileSearchRequest*. For each of the 20 locations, it searches for profiles 
located within R1, R2 and R3 and a random number (new for each query) within the range of 1,000,000 to 10,000,000.
The tests verifies that the search results match the expected results.




  
##### Acceptance Criteria


###### Step 1:

The test successfully obtains list of ports on which the profile server provides its services. 
Then the test successfully establishes hosting agreements for its test identities.
Then the test successfully initializes all test profiles. 


###### Step 2:

The profile server's results for each search query match locally computed expected results. 











#### PS06004 - Profile Search - Invalid Queries

###### Prerequisites:
  * Server's database is empty.

###### Inputs:
  * Server's IP address
  * Server's primary port

##### Description 

The test performs a set of profile search queries with invalid values.

###### Step 1:

The test creates obtains list of service ports and then the test establishes a new TLS connection to the profile server's clNonCustomer port and establishes a conversation.

Then it sends *ProfileSearchRequest*:

  * `Message.id := 2`
  * `ProfileSearchRequest.includeHostedOnly := false`
  * `ProfileSearchRequest.includeThumbnailImages := true`
  * `ProfileSearchRequest.maxResponseRecordCount := 0`
  * `ProfileSearchRequest.maxTotalRecordCount := 1000`
  * `ProfileSearchRequest.type := ""`
  * `ProfileSearchRequest.name := ""`
  * `ProfileSearchRequest.latitude := NO_LOCATION`
  * `ProfileSearchRequest.longitude := NO_LOCATION`
  * `ProfileSearchRequest.radius := 0`
  * `ProfileSearchRequest.extraData := ""`

and reads the response.

Then it sends *ProfileSearchRequest*:

  * `Message.id := 3`
  * `ProfileSearchRequest.includeHostedOnly := false`
  * `ProfileSearchRequest.includeThumbnailImages := true`
  * `ProfileSearchRequest.maxResponseRecordCount := 200`
  * `ProfileSearchRequest.maxTotalRecordCount := 1000`
  * `ProfileSearchRequest.type := ""`
  * `ProfileSearchRequest.name := ""`
  * `ProfileSearchRequest.latitude := NO_LOCATION`
  * `ProfileSearchRequest.longitude := NO_LOCATION`
  * `ProfileSearchRequest.radius := 0`
  * `ProfileSearchRequest.extraData := ""`

and reads the response.

Then it sends *ProfileSearchRequest*:

  * `Message.id := 4`
  * `ProfileSearchRequest.includeHostedOnly := false`
  * `ProfileSearchRequest.includeThumbnailImages := false`
  * `ProfileSearchRequest.maxResponseRecordCount := 1200`
  * `ProfileSearchRequest.maxTotalRecordCount := 2000`
  * `ProfileSearchRequest.type := ""`
  * `ProfileSearchRequest.name := ""`
  * `ProfileSearchRequest.latitude := NO_LOCATION`
  * `ProfileSearchRequest.longitude := NO_LOCATION`
  * `ProfileSearchRequest.radius := 0`
  * `ProfileSearchRequest.extraData := ""`

and reads the response.

Then it sends *ProfileSearchRequest*:

  * `Message.id := 5`
  * `ProfileSearchRequest.includeHostedOnly := false`
  * `ProfileSearchRequest.includeThumbnailImages := true`
  * `ProfileSearchRequest.maxResponseRecordCount := 50`
  * `ProfileSearchRequest.maxTotalRecordCount := 25`
  * `ProfileSearchRequest.type := ""`
  * `ProfileSearchRequest.name := ""`
  * `ProfileSearchRequest.latitude := NO_LOCATION`
  * `ProfileSearchRequest.longitude := NO_LOCATION`
  * `ProfileSearchRequest.radius := 0`
  * `ProfileSearchRequest.extraData := ""`

and reads the response.

Then it sends *ProfileSearchRequest*:

  * `Message.id := 6`
  * `ProfileSearchRequest.includeHostedOnly := false`
  * `ProfileSearchRequest.includeThumbnailImages := true`
  * `ProfileSearchRequest.maxResponseRecordCount := 50`
  * `ProfileSearchRequest.maxTotalRecordCount := 1001`
  * `ProfileSearchRequest.type := ""`
  * `ProfileSearchRequest.name := ""`
  * `ProfileSearchRequest.latitude := NO_LOCATION`
  * `ProfileSearchRequest.longitude := NO_LOCATION`
  * `ProfileSearchRequest.radius := 0`
  * `ProfileSearchRequest.extraData := ""`

and reads the response.

Then it sends *ProfileSearchRequest*:

  * `Message.id := 7`
  * `ProfileSearchRequest.includeHostedOnly := false`
  * `ProfileSearchRequest.includeThumbnailImages := false`
  * `ProfileSearchRequest.maxResponseRecordCount := 50`
  * `ProfileSearchRequest.maxTotalRecordCount := 10010`
  * `ProfileSearchRequest.type := ""`
  * `ProfileSearchRequest.name := ""`
  * `ProfileSearchRequest.latitude := NO_LOCATION`
  * `ProfileSearchRequest.longitude := NO_LOCATION`
  * `ProfileSearchRequest.radius := 0`
  * `ProfileSearchRequest.extraData := ""`

and reads the response.

Then it sends *ProfileSearchRequest*:

  * `Message.id := 8`
  * `ProfileSearchRequest.includeHostedOnly := false`
  * `ProfileSearchRequest.includeThumbnailImages := true`
  * `ProfileSearchRequest.maxResponseRecordCount := 100`
  * `ProfileSearchRequest.maxTotalRecordCount := 1000`
  * `ProfileSearchRequest.type` is set to string containing 70x 'a'
  * `ProfileSearchRequest.name := ""`
  * `ProfileSearchRequest.latitude := NO_LOCATION`
  * `ProfileSearchRequest.longitude := NO_LOCATION`
  * `ProfileSearchRequest.radius := 0`
  * `ProfileSearchRequest.extraData := ""`

and reads the response.

Then it sends *ProfileSearchRequest*:

  * `Message.id := 9`
  * `ProfileSearchRequest.includeHostedOnly := false`
  * `ProfileSearchRequest.includeThumbnailImages := true`
  * `ProfileSearchRequest.maxResponseRecordCount := 100`
  * `ProfileSearchRequest.maxTotalRecordCount := 1000`
  * `ProfileSearchRequest.type` is set to string containing 50x 'É' (UTF8 code 0xc990), which consumes 2 bytes per character
  * `ProfileSearchRequest.name := ""`
  * `ProfileSearchRequest.latitude := NO_LOCATION`
  * `ProfileSearchRequest.longitude := NO_LOCATION`
  * `ProfileSearchRequest.radius := 0`
  * `ProfileSearchRequest.extraData := ""`

and reads the response.


Then it sends *ProfileSearchRequest*:

  * `Message.id := 10`
  * `ProfileSearchRequest.includeHostedOnly := false`
  * `ProfileSearchRequest.includeThumbnailImages := true`
  * `ProfileSearchRequest.maxResponseRecordCount := 100`
  * `ProfileSearchRequest.maxTotalRecordCount := 1000`
  * `ProfileSearchRequest.type := ""`
  * `ProfileSearchRequest.name` is set to string containing 70x 'a'
  * `ProfileSearchRequest.latitude := NO_LOCATION`
  * `ProfileSearchRequest.longitude := NO_LOCATION`
  * `ProfileSearchRequest.radius := 0`
  * `ProfileSearchRequest.extraData := ""`

and reads the response.

Then it sends *ProfileSearchRequest*:

  * `Message.id := 11`
  * `ProfileSearchRequest.includeHostedOnly := false`
  * `ProfileSearchRequest.includeThumbnailImages := true`
  * `ProfileSearchRequest.maxResponseRecordCount := 100`
  * `ProfileSearchRequest.maxTotalRecordCount := 1000`
  * `ProfileSearchRequest.type := ""`
  * `ProfileSearchRequest.name` is set to string containing 50x 'É' (UTF8 code 0xc990), which consumes 2 bytes per character
  * `ProfileSearchRequest.latitude := NO_LOCATION`
  * `ProfileSearchRequest.longitude := NO_LOCATION`
  * `ProfileSearchRequest.radius := 0`
  * `ProfileSearchRequest.extraData := ""`

and reads the response.

Then it sends *ProfileSearchRequest*:

  * `Message.id := 12`
  * `ProfileSearchRequest.includeHostedOnly := false`
  * `ProfileSearchRequest.includeThumbnailImages := true`
  * `ProfileSearchRequest.maxResponseRecordCount := 100`
  * `ProfileSearchRequest.maxTotalRecordCount := 1000`
  * `ProfileSearchRequest.type := ""`
  * `ProfileSearchRequest.name := ""`
  * `ProfileSearchRequest.latitude := -90,000,001`
  * `ProfileSearchRequest.longitude := 1`
  * `ProfileSearchRequest.radius := 1`
  * `ProfileSearchRequest.extraData := ""`

and reads the response.

Then it sends *ProfileSearchRequest*:

  * `Message.id := 13`
  * `ProfileSearchRequest.includeHostedOnly := false`
  * `ProfileSearchRequest.includeThumbnailImages := true`
  * `ProfileSearchRequest.maxResponseRecordCount := 100`
  * `ProfileSearchRequest.maxTotalRecordCount := 1000`
  * `ProfileSearchRequest.type := ""`
  * `ProfileSearchRequest.name := ""`
  * `ProfileSearchRequest.latitude := 90,000,001`
  * `ProfileSearchRequest.longitude := 1`
  * `ProfileSearchRequest.radius := 1`
  * `ProfileSearchRequest.extraData := ""`

and reads the response.

Then it sends *ProfileSearchRequest*:

  * `Message.id := 14`
  * `ProfileSearchRequest.includeHostedOnly := false`
  * `ProfileSearchRequest.includeThumbnailImages := true`
  * `ProfileSearchRequest.maxResponseRecordCount := 100`
  * `ProfileSearchRequest.maxTotalRecordCount := 1000`
  * `ProfileSearchRequest.type := ""`
  * `ProfileSearchRequest.name := ""`
  * `ProfileSearchRequest.latitude := 1`
  * `ProfileSearchRequest.longitude := -180,000,000`
  * `ProfileSearchRequest.radius := 1`
  * `ProfileSearchRequest.extraData := ""`

and reads the response.

Then it sends *ProfileSearchRequest*:

  * `Message.id := 15`
  * `ProfileSearchRequest.includeHostedOnly := false`
  * `ProfileSearchRequest.includeThumbnailImages := true`
  * `ProfileSearchRequest.maxResponseRecordCount := 100`
  * `ProfileSearchRequest.maxTotalRecordCount := 1000`
  * `ProfileSearchRequest.type := ""`
  * `ProfileSearchRequest.name := ""`
  * `ProfileSearchRequest.latitude := 1`
  * `ProfileSearchRequest.longitude := 180,000,001`
  * `ProfileSearchRequest.radius := 1`
  * `ProfileSearchRequest.extraData := ""`

and reads the response.

Then it sends *ProfileSearchRequest*:

  * `Message.id := 16`
  * `ProfileSearchRequest.includeHostedOnly := false`
  * `ProfileSearchRequest.includeThumbnailImages := true`
  * `ProfileSearchRequest.maxResponseRecordCount := 100`
  * `ProfileSearchRequest.maxTotalRecordCount := 1000`
  * `ProfileSearchRequest.type := ""`
  * `ProfileSearchRequest.name := ""`
  * `ProfileSearchRequest.latitude := 1`
  * `ProfileSearchRequest.longitude := 1`
  * `ProfileSearchRequest.radius := 0`
  * `ProfileSearchRequest.extraData := ""`

and reads the response.

Then it sends *ProfileSearchRequest*:

  * `Message.id := 17`
  * `ProfileSearchRequest.includeHostedOnly := false`
  * `ProfileSearchRequest.includeThumbnailImages := true`
  * `ProfileSearchRequest.maxResponseRecordCount := 100`
  * `ProfileSearchRequest.maxTotalRecordCount := 1000`
  * `ProfileSearchRequest.type := ""`
  * `ProfileSearchRequest.name := ""`
  * `ProfileSearchRequest.latitude := NO_LOCATION`
  * `ProfileSearchRequest.longitude := NO_LOCATION`
  * `ProfileSearchRequest.radius := 0`
  * `ProfileSearchRequest.extraData` is set to string containing 300x 'a'

and reads the response.

Then it sends *ProfileSearchRequest*:

  * `Message.id := 18`
  * `ProfileSearchRequest.includeHostedOnly := false`
  * `ProfileSearchRequest.includeThumbnailImages := true`
  * `ProfileSearchRequest.maxResponseRecordCount := 100`
  * `ProfileSearchRequest.maxTotalRecordCount := 1000`
  * `ProfileSearchRequest.type := ""`
  * `ProfileSearchRequest.name := ""`
  * `ProfileSearchRequest.latitude := NO_LOCATION`
  * `ProfileSearchRequest.longitude := NO_LOCATION`
  * `ProfileSearchRequest.radius := 0`
  * `ProfileSearchRequest.extraData` is set to string containing 150x 'É' (UTF8 code 0xc990), which consumes 2 bytes per character

and reads the response.

Then it sends *ProfileSearchRequest*:

  * `Message.id := 19`
  * `ProfileSearchRequest.includeHostedOnly := false`
  * `ProfileSearchRequest.includeThumbnailImages := true`
  * `ProfileSearchRequest.maxResponseRecordCount := 100`
  * `ProfileSearchRequest.maxTotalRecordCount := 1000`
  * `ProfileSearchRequest.type := ""`
  * `ProfileSearchRequest.name := ""`
  * `ProfileSearchRequest.latitude := NO_LOCATION`
  * `ProfileSearchRequest.longitude := NO_LOCATION`
  * `ProfileSearchRequest.radius := 0`
  * `ProfileSearchRequest.extraData := "(^|;)key=([^=]+;)?va(?'alpha')lue($|,|;)"`

and reads the response.

Then it sends *ProfileSearchRequest*:

  * `Message.id := 20`
  * `ProfileSearchRequest.includeHostedOnly := false`
  * `ProfileSearchRequest.includeThumbnailImages := true`
  * `ProfileSearchRequest.maxResponseRecordCount := 100`
  * `ProfileSearchRequest.maxTotalRecordCount := 1000`
  * `ProfileSearchRequest.type := ""`
  * `ProfileSearchRequest.name := ""`
  * `ProfileSearchRequest.latitude := NO_LOCATION`
  * `ProfileSearchRequest.longitude := NO_LOCATION`
  * `ProfileSearchRequest.radius := 0`
  * `ProfileSearchRequest.extraData := "iuawhefiuhawef\aaerwergj"`

and reads the response.

Then it sends *ProfileSearchRequest*:

  * `Message.id := 21`
  * `ProfileSearchRequest.includeHostedOnly := false`
  * `ProfileSearchRequest.includeThumbnailImages := true`
  * `ProfileSearchRequest.maxResponseRecordCount := 100`
  * `ProfileSearchRequest.maxTotalRecordCount := 1000`
  * `ProfileSearchRequest.type := ""`
  * `ProfileSearchRequest.name := ""`
  * `ProfileSearchRequest.latitude := NO_LOCATION`
  * `ProfileSearchRequest.longitude := NO_LOCATION`
  * `ProfileSearchRequest.radius := 0`
  * `ProfileSearchRequest.extraData := "aerghearg\beraarg"`

and reads the response.

Then it sends *ProfileSearchRequest*:

  * `Message.id := 22`
  * `ProfileSearchRequest.includeHostedOnly := false`
  * `ProfileSearchRequest.includeThumbnailImages := true`
  * `ProfileSearchRequest.maxResponseRecordCount := 100`
  * `ProfileSearchRequest.maxTotalRecordCount := 1000`
  * `ProfileSearchRequest.type := ""`
  * `ProfileSearchRequest.name := ""`
  * `ProfileSearchRequest.latitude := NO_LOCATION`
  * `ProfileSearchRequest.longitude := NO_LOCATION`
  * `ProfileSearchRequest.radius := 0`
  * `ProfileSearchRequest.extraData := "afewafawefwaef\"`

and reads the response.

Then it sends *ProfileSearchRequest*:

  * `Message.id := 23`
  * `ProfileSearchRequest.includeHostedOnly := false`
  * `ProfileSearchRequest.includeThumbnailImages := true`
  * `ProfileSearchRequest.maxResponseRecordCount := 100`
  * `ProfileSearchRequest.maxTotalRecordCount := 1000`
  * `ProfileSearchRequest.type := ""`
  * `ProfileSearchRequest.name := ""`
  * `ProfileSearchRequest.latitude := NO_LOCATION`
  * `ProfileSearchRequest.longitude := NO_LOCATION`
  * `ProfileSearchRequest.radius := 0`
  * `ProfileSearchRequest.extraData := "(^|;)key=([^=]+;)?(?<double>A)B<double>($|,|;)"`

and reads the response.

Then it sends *ProfileSearchRequest*:

  * `Message.id := 24`
  * `ProfileSearchRequest.includeHostedOnly := false`
  * `ProfileSearchRequest.includeThumbnailImages := true`
  * `ProfileSearchRequest.maxResponseRecordCount := 100`
  * `ProfileSearchRequest.maxTotalRecordCount := 1000`
  * `ProfileSearchRequest.type := ""`
  * `ProfileSearchRequest.name := ""`
  * `ProfileSearchRequest.latitude := NO_LOCATION`
  * `ProfileSearchRequest.longitude := NO_LOCATION`
  * `ProfileSearchRequest.radius := 0`
  * `ProfileSearchRequest.extraData := "(^|;)key=rai??n($|,|;)"`

and reads the response.


###### Step 2:

Then it sends *ProfileSearchPartRequest*:

  * `Message.id := 25`
  * `ProfileSearchPartRequest.recordIndex := 10`
  * `ProfileSearchPartRequest.recordCount := 20`



##### Acceptance Criteria

###### Step 1:

The test successfully obtains list of ports on which the profile server provides its services and establishes a conversation.

Server replies with *Response*:

  * `Message.id == 2`
  * `Response.status == ERROR_INVALID_VALUE`
  * `Response.details == "maxResponseRecordCount"`

Server replies with *Response*:

  * `Message.id == 3`
  * `Response.status == ERROR_INVALID_VALUE`
  * `Response.details == "maxResponseRecordCount"`

Server replies with *Response*:

  * `Message.id == 4`
  * `Response.status == ERROR_INVALID_VALUE`
  * `Response.details == "maxResponseRecordCount"`

Server replies with *Response*:

  * `Message.id == 5`
  * `Response.status == ERROR_INVALID_VALUE`
  * `Response.details == "maxResponseRecordCount"`

Server replies with *Response*:

  * `Message.id == 6`
  * `Response.status == ERROR_INVALID_VALUE`
  * `Response.details == "maxTotalRecordCount"`

Server replies with *Response*:

  * `Message.id == 7`
  * `Response.status == ERROR_INVALID_VALUE`
  * `Response.details == "maxTotalRecordCount"`

Server replies with *Response*:

  * `Message.id == 8`
  * `Response.status == ERROR_INVALID_VALUE`
  * `Response.details == "type"`

Server replies with *Response*:

  * `Message.id == 9`
  * `Response.status == ERROR_INVALID_VALUE`
  * `Response.details == "type"`

Server replies with *Response*:

  * `Message.id == 10`
  * `Response.status == ERROR_INVALID_VALUE`
  * `Response.details == "name"`

Server replies with *Response*:

  * `Message.id == 11`
  * `Response.status == ERROR_INVALID_VALUE`
  * `Response.details == "name"`

Server replies with *Response*:

  * `Message.id == 12`
  * `Response.status == ERROR_INVALID_VALUE`
  * `Response.details == "latitude"`

Server replies with *Response*:

  * `Message.id == 13`
  * `Response.status == ERROR_INVALID_VALUE`
  * `Response.details == "latitude"`

Server replies with *Response*:

  * `Message.id == 14`
  * `Response.status == ERROR_INVALID_VALUE`
  * `Response.details == "longitude"`

Server replies with *Response*:

  * `Message.id == 15`
  * `Response.status == ERROR_INVALID_VALUE`
  * `Response.details == "longitude"`

Server replies with *Response*:

  * `Message.id == 16`
  * `Response.status == ERROR_INVALID_VALUE`
  * `Response.details == "radius"`

Server replies with *Response*:

  * `Message.id == 17`
  * `Response.status == ERROR_INVALID_VALUE`
  * `Response.details == "extraData"`

Server replies with *Response*:

  * `Message.id == 18`
  * `Response.status == ERROR_INVALID_VALUE`
  * `Response.details == "extraData"`

Server replies with *Response*:

  * `Message.id == 19`
  * `Response.status == ERROR_INVALID_VALUE`
  * `Response.details == "extraData"`

Server replies with *Response*:

  * `Message.id == 20`
  * `Response.status == ERROR_INVALID_VALUE`
  * `Response.details == "extraData"`

Server replies with *Response*:

  * `Message.id == 21`
  * `Response.status == ERROR_INVALID_VALUE`
  * `Response.details == "extraData"`

Server replies with *Response*:

  * `Message.id == 22`
  * `Response.status == ERROR_INVALID_VALUE`
  * `Response.details == "extraData"`

Server replies with *Response*:

  * `Message.id == 23`
  * `Response.status == ERROR_INVALID_VALUE`
  * `Response.details == "extraData"`

Server replies with *Response*:

  * `Message.id == 24`
  * `Response.status == ERROR_INVALID_VALUE`
  * `Response.details == "extraData"`


###### Step 2:

Then it sends *ProfileSearchPartRequest*:

  * `Message.id := 25`
  * `Response.status == ERROR_NOT_AVAILABLE`






